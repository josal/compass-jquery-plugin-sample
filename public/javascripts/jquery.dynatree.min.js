var _canLog=true;function _log(g){if(_canLog){var j=Array.prototype.slice.apply(arguments,[1]),i=new Date;i=i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()+"."+i.getMilliseconds();j[0]=i+" - "+j[0];try{switch(g){case "info":window.console.info.apply(window.console,j);break;case "warn":window.console.warn.apply(window.console,j);break;default:window.console.log.apply(window.console,j)}}catch(k){window.console||(_canLog=false)}}}
function logMsg(){Array.prototype.unshift.apply(arguments,["debug"]);_log.apply(this,arguments)}var getDynaTreePersistData=undefined,DTNodeStatus_Error=-1,DTNodeStatus_Loading=1,DTNodeStatus_Ok=0;
(function(g){var j={create:function(){return function(){this.initialize.apply(this,arguments)}}},i=j.create();i.prototype={initialize:function(a,b,c){this.parent=a;this.tree=b;if(typeof c=="string")c={title:c};if(c.key==undefined)c.key="_"+b._nodeCount++;this.data=g.extend({},g.ui.dynatree.nodedatadefaults,c);this.childList=this.span=this.div=null;this.hasSubSel=this.isLoading=false},toString:function(){return"dtnode<"+this.data.key+">: '"+this.data.title+"'"},toDict:function(a,b){var c=g.extend({},
this.data);c.activate=this.tree.activeNode===this;c.focus=this.tree.focusNode===this;c.expand=this.bExpanded;c.select=this.bSelected;b&&b(c);if(a&&this.childList){c.children=[];for(a=0;a<this.childList.length;a++)c.children.push(this.childList[a].toDict(true,b))}else delete c.children;return c},_getInnerHtml:function(){for(var a=this.tree.options,b=this.tree.cache,c=a.rootVisible?null:this.tree.tnRoot,d=a.rootVisible&&a.minExpandLevel>0||a.minExpandLevel>1,e=a.rootVisible||a.minExpandLevel>0,f="",
h=this.parent;h;){if(e&&h==c)break;f=(h.isLastSibling()?b.tagEmpty:b.tagVline)+f;h=h.parent}d&&this.parent==c||(f+=this.childList||this.data.isLazy?b.tagExpander:b.tagConnector);if(a.checkbox&&this.data.hideCheckbox!=true&&!this.data.isStatusNode)f+=b.tagCheckbox;if(this.data.icon)f+="<img src='"+a.imagePath+this.data.icon+"' alt='' />";else if(this.data.icon!=false)f+=b.tagNodeIcon;f+="<a href='#' class='"+a.classNames.title+"'"+(this.data&&typeof this.data.tooltip=="string"?" title='"+this.data.tooltip+
"'":"")+">"+this.data.title+"</a>";return f},_fixOrder:function(){var a=this.childList;if(a)for(var b=this.div.firstChild.nextSibling,c=0;c<a.length-1;c++){var d=a[c],e=b.firstChild.dtnode;if(d!==e){this.tree.logDebug("_fixOrder: mismatch at index "+c+": "+d+" != "+e);this.div.insertBefore(d.div,e.div)}else b=b.nextSibling}},render:function(a,b){var c=this.tree.options.classNames,d=this.isLastSibling();if(!this.div){this.span=document.createElement("span");this.span.dtnode=this;if(this.data.key)this.span.id=
this.tree.options.idPrefix+this.data.key;this.div=document.createElement("div");this.div.appendChild(this.span);this.parent&&this.parent.div.appendChild(this.div);if(this.parent==null&&!this.tree.options.rootVisible)this.span.style.display="none"}this.span.innerHTML=this._getInnerHtml();this.div.style.display=this.parent==null||this.parent.bExpanded?"":"none";var e=[];e.push(this.data.isFolder?c.folder:c.document);this.bExpanded&&e.push(c.expanded);this.childList!=null&&e.push(c.hasChildren);this.data.isLazy&&
this.childList==null&&e.push(c.lazy);d&&e.push(c.lastsib);this.bSelected&&e.push(c.selected);this.hasSubSel&&e.push(c.partsel);this.tree.activeNode===this&&e.push(c.active);this.data.addClass&&e.push(this.data.addClass);e.push(c.combinedExpanderPrefix+(this.bExpanded?"e":"c")+(this.data.isLazy&&this.childList==null?"d":"")+(d?"l":""));e.push(c.combinedIconPrefix+(this.bExpanded?"e":"c")+(this.data.isFolder?"f":""));this.span.className=e.join(" ");if(a&&this.childList&&(b||this.bExpanded)){for(c=0;c<
this.childList.length;c++)this.childList[c].render(a,b);this._fixOrder()}},hasChildren:function(){return this.childList!=null},isLastSibling:function(){var a=this.parent;if(!a)return true;return a.childList[a.childList.length-1]===this},prevSibling:function(){if(!this.parent)return null;for(var a=this.parent.childList,b=1;b<a.length;b++)if(a[b]===this)return a[b-1];return null},nextSibling:function(){if(!this.parent)return null;for(var a=this.parent.childList,b=0;b<a.length-1;b++)if(a[b]===this)return a[b+
1];return null},_setStatusNode:function(a){var b=this.childList?this.childList[0]:null;if(a)if(b){a.isStatusNode=true;b.data=a;b.render(false,false)}else{a.isStatusNode=true;this.addChild(a)}else if(b){this.div.removeChild(b.div);if(this.childList.length==1)this.childList=null;else this.childList.shift()}},setLazyNodeStatus:function(a){switch(a){case DTNodeStatus_Ok:this._setStatusNode(null);this.isLoading=false;this.render(false,false);if(this.tree.options.autoFocus)this===this.tree.tnRoot&&!this.tree.options.rootVisible&&
this.childList?this.childList[0].focus():this.focus();break;case DTNodeStatus_Loading:this.isLoading=true;this._setStatusNode({title:this.tree.options.strings.loading,addClass:this.tree.options.classNames.nodeWait});break;case DTNodeStatus_Error:this.isLoading=false;this._setStatusNode({title:this.tree.options.strings.loadError,addClass:this.tree.options.classNames.nodeError});break;default:throw"Bad LazyNodeStatus: '"+a+"'.";}},_parentList:function(a,b){var c=[];for(b=b?this:this.parent;b;){if(a||
b.parent)c.unshift(b);b=b.parent}return c},getLevel:function(){for(var a=0,b=this.parent;b;){a++;b=b.parent}return a},_getTypeForOuterNodeEvent:function(a){var b=this.tree.options.classNames,c=a.target;if(c.className.indexOf(b.folder)<0&&c.className.indexOf(b.document)<0)return null;var d=a.pageX-c.offsetLeft;a=a.pageY-c.offsetTop;for(var e=0;e<c.childNodes.length;e++){var f=c.childNodes[e],h=f.offsetLeft-c.offsetLeft,l=f.offsetTop-c.offsetTop,n=f.clientWidth,o=f.clientHeight;if(d>=h&&d<=h+n&&a>=
l&&a<=l+o)if(f.className==b.title)return"title";else if(f.className==b.expander)return"expander";else if(f.className==b.checkbox)return"checkbox";else if(f.className==b.nodeIcon)return"icon"}return"prefix"},getEventTargetType:function(a){var b=a&&a.target?a.target.className:"",c=this.tree.options.classNames;if(b==c.title)return"title";else if(b==c.expander)return"expander";else if(b==c.checkbox)return"checkbox";else if(b==c.nodeIcon)return"icon";else if(b==c.empty||b==c.vline||b==c.connector)return"prefix";
else if(b.indexOf(c.folder)>=0||b.indexOf(c.document)>=0)return this._getTypeForOuterNodeEvent(a);return null},isVisible:function(){for(var a=this._parentList(true,false),b=0;b<a.length;b++)if(!a[b].bExpanded)return false;return true},makeVisible:function(){for(var a=this._parentList(true,false),b=0;b<a.length;b++)a[b]._expand(true)},focus:function(){this.makeVisible();try{g(this.span).find(">a").focus()}catch(a){}},_activate:function(a,b){this.tree.logDebug("dtnode._activate(%o, fireEvents=%o) - %o",
a,b,this);var c=this.tree.options;if(!this.data.isStatusNode)if(!(b&&c.onQueryActivate&&c.onQueryActivate.call(this.span,a,this)==false))if(a){if(this.tree.activeNode){if(this.tree.activeNode===this)return;this.tree.activeNode.deactivate()}c.activeVisible&&this.makeVisible();this.tree.activeNode=this;c.persist&&g.cookie(c.cookieId+"-active",this.data.key,c.cookie);this.tree.persistence.activeKey=this.data.key;g(this.span).addClass(c.classNames.active);b&&c.onActivate&&c.onActivate.call(this.span,
this)}else if(this.tree.activeNode===this){c=this.tree.options;if(!(c.onQueryActivate&&c.onQueryActivate.call(this.span,false,this)==false)){g(this.span).removeClass(c.classNames.active);c.persist&&g.cookie(c.cookieId+"-active","",c.cookie);this.tree.persistence.activeKey=null;this.tree.activeNode=null;b&&c.onDeactivate&&c.onDeactivate.call(this.span,this)}}},activate:function(){this._activate(true,true)},deactivate:function(){this._activate(false,true)},isActive:function(){return this.tree.activeNode===
this},_userActivate:function(){var a=true,b=false;if(this.data.isFolder)switch(this.tree.options.clickFolderMode){case 2:a=false;b=true;break;case 3:a=b=true;break}if(this.parent==null&&this.tree.options.minExpandLevel>0)b=false;if(b){this.toggleExpand();this.focus()}a&&this.activate()},_setSubSel:function(a){if(a){this.hasSubSel=true;g(this.span).addClass(this.tree.options.classNames.partsel)}else{this.hasSubSel=false;g(this.span).removeClass(this.tree.options.classNames.partsel)}},_fixSelectionState:function(){if(this.bSelected){this.visit(function(e){e.parent._setSubSel(true);
e._select(true,false,false)});for(var a=this.parent;a;){a._setSubSel(true);for(var b=true,c=0;c<a.childList.length;c++){var d=a.childList[c];if(!d.bSelected&&!d.data.isStatusNode){b=false;break}}b&&a._select(true,false,false);a=a.parent}}else{this._setSubSel(false);this.visit(function(e){e._setSubSel(false);e._select(false,false,false)});for(a=this.parent;a;){a._select(false,false,false);b=false;for(c=0;c<a.childList.length;c++)if(a.childList[c].bSelected||a.childList[c].hasSubSel){b=true;break}a._setSubSel(b);
a=a.parent}}},_select:function(a,b,c){var d=this.tree.options;if(!this.data.isStatusNode)if(this.bSelected!=a)if(!(b&&d.onQuerySelect&&d.onQuerySelect.call(this.span,a,this)==false)){d.selectMode==1&&a&&this.tree.visit(function(e){if(e.bSelected){e._select(false,false,false);return false}});if(this.bSelected=a){d.persist&&this.tree.persistence.addSelect(this.data.key);g(this.span).addClass(d.classNames.selected);c&&d.selectMode==3&&this._fixSelectionState();b&&d.onSelect&&d.onSelect.call(this.span,
true,this)}else{d.persist&&this.tree.persistence.clearSelect(this.data.key);g(this.span).removeClass(d.classNames.selected);c&&d.selectMode==3&&this._fixSelectionState();b&&d.onSelect&&d.onSelect.call(this.span,false,this)}}},select:function(a){if(this.data.unselectable)return this.bSelected;return this._select(a!=false,true,true)},toggleSelect:function(){return this.select(!this.bSelected)},isSelected:function(){return this.bSelected},_loadContent:function(){try{var a=this.tree.options;this.tree.logDebug("_loadContent: start - %o",
this);this.setLazyNodeStatus(DTNodeStatus_Loading);if(true==a.onLazyRead.call(this.span,this)){this.setLazyNodeStatus(DTNodeStatus_Ok);this.tree.logDebug("_loadContent: succeeded - %o",this)}}catch(b){alert(b);this.setLazyNodeStatus(DTNodeStatus_Error)}},_expand:function(a){if(this.bExpanded!=a){var b=this.tree.options;if(!a&&this.getLevel()<b.minExpandLevel)this.tree.logDebug("dtnode._expand(%o) forced expand - %o",a,this);else if(!(b.onQueryExpand&&b.onQueryExpand.call(this.span,a,this)==false)){this.bExpanded=
a;if(b.persist)a?this.tree.persistence.addExpand(this.data.key):this.tree.persistence.clearExpand(this.data.key);this.render(false);if(this.bExpanded&&this.parent&&b.autoCollapse)for(var c=this._parentList(false,true),d=0;d<c.length;d++)c[d].collapseSiblings();b.activeVisible&&this.tree.activeNode&&!this.tree.activeNode.isVisible()&&this.tree.activeNode.deactivate();if(a&&this.data.isLazy&&this.childList==null&&!this.isLoading)this._loadContent();else{c=b.fx?b.fx.duration||200:0;if(this.childList)for(d=
0;d<this.childList.length;d++){var e=g(this.childList[d].div);if(c)a!=e.is(":visible")&&e.animate(b.fx,c);else a?e.show():e.hide()}b.onExpand&&b.onExpand.call(this.span,a,this)}}}},expand:function(a){!this.childList&&!this.data.isLazy&&a||this.parent==null&&this.tree.options.minExpandLevel>0&&!a||this._expand(a)},toggleExpand:function(){this.expand(!this.bExpanded)},collapseSiblings:function(){if(this.parent!=null)for(var a=this.parent.childList,b=0;b<a.length;b++)a[b]!==this&&a[b].bExpanded&&a[b]._expand(false)},
onClick:function(a){a=this.getEventTargetType(a);if(a=="expander"){this.toggleExpand();this.focus()}else if(a=="checkbox"){this.toggleSelect();this.focus()}else{this._userActivate();this.span.getElementsByTagName("a")[0].focus()}return false},onDblClick:function(){},onKeydown:function(a){var b=true;switch(a.which){case 107:case 187:this.bExpanded||this.toggleExpand();break;case 109:case 189:this.bExpanded&&this.toggleExpand();break;case 32:this._userActivate();break;case 8:this.parent&&this.parent.focus();
break;case 37:if(this.bExpanded){this.toggleExpand();this.focus()}else if(this.parent&&(this.tree.options.rootVisible||this.parent.parent))this.parent.focus();break;case 39:if(!this.bExpanded&&(this.childList||this.data.isLazy)){this.toggleExpand();this.focus()}else this.childList&&this.childList[0].focus();break;case 38:for(var c=this.prevSibling();c&&c.bExpanded&&c.childList;)c=c.childList[c.childList.length-1];if(!c&&this.parent&&(this.tree.options.rootVisible||this.parent.parent))c=this.parent;
c&&c.focus();break;case 40:if(this.bExpanded&&this.childList)c=this.childList[0];else{a=this._parentList(false,true);for(var d=a.length-1;d>=0;d--)if(c=a[d].nextSibling())break}c&&c.focus();break;default:b=false}return!b},onKeypress:function(){},onFocus:function(a){var b=this.tree.options;if(a.type=="blur"||a.type=="focusout"){b.onBlur&&b.onBlur.call(this.span,this);this.tree.tnFocused&&g(this.tree.tnFocused.span).removeClass(b.classNames.focused);this.tree.tnFocused=null;b.persist&&g.cookie(b.cookieId+
"-focus","",b.cookie)}else if(a.type=="focus"||a.type=="focusin"){if(this.tree.tnFocused&&this.tree.tnFocused!==this){this.tree.logDebug("dtnode.onFocus: out of sync: curFocus: %o",this.tree.tnFocused);g(this.tree.tnFocused.span).removeClass(b.classNames.focused)}this.tree.tnFocused=this;b.onFocus&&b.onFocus.call(this.span,this);g(this.tree.tnFocused.span).addClass(b.classNames.focused);b.persist&&g.cookie(b.cookieId+"-focus",this.data.key,b.cookie)}},visit:function(a,b,c){var d=0;if(c==true){if(a(this,
b)==false)return 1;d++}if(this.childList)for(c=0;c<this.childList.length;c++)d+=this.childList[c].visit(a,b,true);return d},remove:function(){if(this===this.tree.root)return false;return this.parent.removeChild(this)},removeChild:function(a){var b=this.childList;if(b.length==1){if(a!==b[0])throw"removeChild: invalid child";return this.removeChildren()}a===this.tree.activeNode&&a.deactivate();if(this.tree.options.persist){a.bSelected&&this.tree.persistence.clearSelect(a.data.key);a.bExpanded&&this.tree.persistence.clearExpand(a.data.key)}a.removeChildren(true);
this.div.removeChild(a.div);for(var c=0;c<b.length;c++)if(b[c]===a){this.childList.splice(c,1);delete a;break}},removeChildren:function(a,b){var c=this.tree,d=this.childList;if(d){for(var e=0;e<d.length;e++){var f=d[e];f===c.activeNode&&!b&&f.deactivate();if(this.tree.options.persist&&!b){f.bSelected&&this.tree.persistence.clearSelect(f.data.key);f.bExpanded&&this.tree.persistence.clearExpand(f.data.key)}f.removeChildren(true,b);this.div.removeChild(f.div);delete f}this.childList=null}if(!a){this.isLoading=
false;this.render(false,false)}},reload:function(a){if(this.parent==null)return this.tree.reload();if(!this.data.isLazy)throw"node.reload() requires lazy nodes.";if(this.bExpanded){this.expand(false);this.removeChildren();this.expand(true)}else{this.removeChildren();a&&this._loadContent()}},_addChildNode:function(a,b){var c=this.tree,d=c.options,e=c.persistence;a.parent=this;if(this.childList==null)this.childList=[];else b||g(this.childList[this.childList.length-1].span).removeClass(d.classNames.lastsib);
if(b){b=g.inArray(b,this.childList);if(b<0)throw"<beforeNode> must be a child of <this>";this.childList.splice(b,0,a)}else this.childList.push(a);b=c.isInitializing();if(d.persist&&e.cookiesFound&&b){if(e.activeKey==a.data.key)c.activeNode=a;if(e.focusedKey==a.data.key)c.focusNode=a;a.bExpanded=g.inArray(a.data.key,e.expandedKeyList)>=0;a.bSelected=g.inArray(a.data.key,e.selectedKeyList)>=0}else{if(a.data.activate){c.activeNode=a;if(d.persist)e.activeKey=a.data.key}if(a.data.focus){c.focusNode=a;
if(d.persist)e.focusedKey=a.data.key}a.bExpanded=a.data.expand==true;a.bExpanded&&d.persist&&e.addExpand(a.data.key);a.bSelected=a.data.select==true;a.bSelected&&d.persist&&e.addSelect(a.data.key)}if(d.minExpandLevel>=a.getLevel())this.bExpanded=true;if(a.bSelected&&d.selectMode==3)for(d=this;d;){d.hasSubSel||d._setSubSel(true);d=d.parent}c.bEnableUpdate&&this.render(true,true);return a},addChild:function(a,b){if(!(!a||a.length==0)){if(a instanceof i)return this._addChildNode(a,b);a.length||(a=[a]);
for(var c=this.tree.enableUpdate(false),d=null,e=0;e<a.length;e++){var f=a[e],h=this._addChildNode(new i(this,this.tree,f),b);d||(d=h);f.children&&h.addChild(f.children,null)}this.tree.enableUpdate(c);return d}},append:function(a){this.tree.logWarning("node.append() is deprecated (use node.addChild() instead).");return this.addChild(a,null)},appendAjax:function(a){this.removeChildren(false,true);this.setLazyNodeStatus(DTNodeStatus_Loading);var b=this,c=a.success,d=a.error,e=g.extend({},this.tree.options.ajaxDefaults,
a,{success:function(f){var h=b.tree.phase;b.tree.phase="init";b.addChild(f,null);b.tree.phase="postInit";b.setLazyNodeStatus(DTNodeStatus_Ok);c&&c.call(e,b);b.tree.phase=h},error:function(f,h,l){b.setLazyNodeStatus(DTNodeStatus_Error);d&&d.call(e,b,f,h,l)}});g.ajax(e)},lastentry:undefined};var k=j.create();k._getTreePersistData=function(a,b){a=new k(a,b);a.read();return a.toDict()};getDynaTreePersistData=k._getTreePersistData;k.prototype={initialize:function(a,b){this._log("DynaTreeStatus: initialize");
if(a===undefined)a=g.ui.dynatree.defaults.cookieId;b=g.extend({},g.ui.dynatree.defaults.cookie,b);this.cookieId=a;this.cookieOpts=b;this.cookiesFound=undefined;this.selectedKeyList=this.expandedKeyList=this.focusedKey=this.activeKey=null},_log:function(){Array.prototype.unshift.apply(arguments,["debug"]);_log.apply(this,arguments)},read:function(){this._log("DynaTreeStatus: read");this.cookiesFound=false;var a=g.cookie(this.cookieId+"-active");this.activeKey=a==null?"":a;if(a!=null)this.cookiesFound=
true;a=g.cookie(this.cookieId+"-focus");this.focusedKey=a==null?"":a;if(a!=null)this.cookiesFound=true;a=g.cookie(this.cookieId+"-expand");this.expandedKeyList=a==null?[]:a.split(",");if(a!=null)this.cookiesFound=true;a=g.cookie(this.cookieId+"-select");this.selectedKeyList=a==null?[]:a.split(",");if(a!=null)this.cookiesFound=true},write:function(){this._log("DynaTreeStatus: write");g.cookie(this.cookieId+"-active",this.activeKey==null?"":this.activeKey,this.cookieOpts);g.cookie(this.cookieId+"-focus",
this.focusedKey==null?"":this.focusedKey,this.cookieOpts);g.cookie(this.cookieId+"-expand",this.expandedKeyList==null?"":this.expandedKeyList.join(","),this.cookieOpts);g.cookie(this.cookieId+"-select",this.selectedKeyList==null?"":this.selectedKeyList.join(","),this.cookieOpts)},addExpand:function(a){this._log("addExpand(%o)",a);if(g.inArray(a,this.expandedKeyList)<0){this.expandedKeyList.push(a);g.cookie(this.cookieId+"-expand",this.expandedKeyList.join(","),this.cookieOpts)}},clearExpand:function(a){this._log("clearExpand(%o)",
a);a=g.inArray(a,this.expandedKeyList);if(a>=0){this.expandedKeyList.splice(a,1);g.cookie(this.cookieId+"-expand",this.expandedKeyList.join(","),this.cookieOpts)}},addSelect:function(a){this._log("addSelect(%o)",a);if(g.inArray(a,this.selectedKeyList)<0){this.selectedKeyList.push(a);g.cookie(this.cookieId+"-select",this.selectedKeyList.join(","),this.cookieOpts)}},clearSelect:function(a){this._log("clearSelect(%o)",a);a=g.inArray(a,this.selectedKeyList);if(a>=0){this.selectedKeyList.splice(a,1);g.cookie(this.cookieId+
"-select",this.selectedKeyList.join(","),this.cookieOpts)}},isReloading:function(){return this.cookiesFound==true},toDict:function(){return{cookiesFound:this.cookiesFound,activeKey:this.activeKey,focusedKey:this.activeKey,expandedKeyList:this.expandedKeyList,selectedKeyList:this.selectedKeyList}},lastentry:undefined};var m=j.create();m.version="$Version: 0.5.2$";m.prototype={initialize:function(a){this.phase="init";this.$widget=a;this.options=a.options;this.$tree=a.element;this.divTree=this.$tree.get(0)},
_load:function(){var a=this.options;this.bEnableUpdate=true;this._nodeCount=1;this.focusNode=this.activeNode=null;if(a.classNames!==g.ui.dynatree.defaults.classNames)a.classNames=g.extend({},g.ui.dynatree.defaults.classNames,a.classNames);a.imagePath||g("script").each(function(){if(this.src.search(_rexDtLibName)>=0){a.imagePath=this.src.indexOf("/")>=0?this.src.slice(0,this.src.lastIndexOf("/"))+"/skin/":"skin/";return false}});this.persistence=new k(a.cookieId,a.cookie);if(a.persist){g.cookie||_log("warn",
"Please include jquery.cookie.js to use persistence.");this.persistence.read()}this.logDebug("DynaTree.persistence: %o",this.persistence.toDict());this.cache={tagEmpty:"<span class='"+a.classNames.empty+"'></span>",tagVline:"<span class='"+a.classNames.vline+"'></span>",tagExpander:"<span class='"+a.classNames.expander+"'></span>",tagConnector:"<span class='"+a.classNames.connector+"'></span>",tagNodeIcon:"<span class='"+a.classNames.nodeIcon+"'></span>",tagCheckbox:"<span class='"+a.classNames.checkbox+
"'></span>",lastentry:undefined};if(a.children||a.initAjax&&a.initAjax.url||a.initId)g(this.divTree).empty();else this.divRoot&&g(this.divRoot).remove();this.tnRoot=new i(null,this,{title:a.title,key:"root"});this.tnRoot.data.isFolder=true;this.tnRoot.render(false,false);this.divRoot=this.tnRoot.div;this.divRoot.className=a.classNames.container;this.divTree.appendChild(this.divRoot);var b=this.tnRoot,c=a.persist&&this.persistence.isReloading(),d=false,e=this.enableUpdate(false);this.logDebug("Dynatree._load(): read tree structure...");
if(a.children)b.addChild(a.children);else if(a.initAjax&&a.initAjax.url){d=true;b.data.isLazy=true;this._reloadAjax()}else if(a.initId)this._createFromTag(b,g("#"+a.initId));else{var f=this.$tree.find(">ul").hide();this._createFromTag(b,f);f.remove()}this._checkConsistency();this.logDebug("Dynatree._load(): render nodes...");this.enableUpdate(e);this.logDebug("Dynatree._load(): bind events...");this.$widget.bind();this.logDebug("Dynatree._load(): postInit...");this.phase="postInit";a.persist&&this.persistence.write();
if(this.focusNode&&this.focusNode.isVisible()){this.logDebug("Focus on init: %o",this.focusNode);this.focusNode.focus()}!d&&a.onPostInit&&a.onPostInit.call(this,c,false);this.phase="idle"},_reloadAjax:function(){var a=this.options;if(!a.initAjax||!a.initAjax.url)throw"tree.reload() requires 'initAjax' mode.";var b=this.persistence,c=g.extend({},a.initAjax);if(c.addActiveKey)c.data.activeKey=b.activeKey;if(c.addFocusedKey)c.data.focusedKey=b.focusedKey;if(c.addExpandedKeyList)c.data.expandedKeyList=
b.expandedKeyList.join(",");if(c.addSelectedKeyList)c.data.selectedKeyList=b.selectedKeyList.join(",");if(a.onPostInit){c.success&&this.tree.logWarning("initAjax: success callback is ignored when onPostInit was specified.");c.error&&this.tree.logWarning("initAjax: error callback is ignored when onPostInit was specified.");var d=b.isReloading();c.success=function(e){a.onPostInit.call(e.tree,d,false)};c.error=function(e){a.onPostInit.call(e.tree,d,true)}}this.logDebug("Dynatree._init(): send Ajax request...");
this.tnRoot.appendAjax(c)},toString:function(){return"DynaTree '"+this.options.title+"'"},toDict:function(){return this.tnRoot.toDict(true)},getPersistData:function(){return this.persistence.toDict()},logDebug:function(){if(this.options.debugLevel>=2){Array.prototype.unshift.apply(arguments,["debug"]);_log.apply(this,arguments)}},logInfo:function(){if(this.options.debugLevel>=1){Array.prototype.unshift.apply(arguments,["info"]);_log.apply(this,arguments)}},logWarning:function(){Array.prototype.unshift.apply(arguments,
["warn"]);_log.apply(this,arguments)},isInitializing:function(){return this.phase=="init"||this.phase=="postInit"},isReloading:function(){return(this.phase=="init"||this.phase=="postInit")&&this.options.persist&&this.persistence.cookiesFound},isUserEvent:function(){return this.phase=="userEvent"},redraw:function(){this.logDebug("dynatree.redraw()...");this.tnRoot.render(true,true);this.logDebug("dynatree.redraw() done.")},reloadAjax:function(){this.logWarning("tree.reloadAjax() is deprecated since v0.5.2 (use reload() instead).")},
reload:function(){this._load()},getRoot:function(){return this.tnRoot},getNodeByKey:function(a){return(a=document.getElementById(this.options.idPrefix+a))&&a.dtnode?a.dtnode:null},getActiveNode:function(){return this.activeNode},reactivate:function(a){var b=this.activeNode;if(b){this.activeNode=null;b.activate();a&&b.focus()}},getSelectedNodes:function(a){var b=[];this.tnRoot.visit(function(c){if(c.bSelected){b.push(c);if(a==true)return false}});return b},activateKey:function(a){a=a===null?null:this.getNodeByKey(a);
if(!a){this.activeNode&&this.activeNode.deactivate();return this.activeNode=null}a.focus();a.activate();return a},selectKey:function(a,b){a=this.getNodeByKey(a);if(!a)return null;a.select(b);return a},enableUpdate:function(a){if(this.bEnableUpdate==a)return a;(this.bEnableUpdate=a)&&this.redraw();return!a},visit:function(a,b,c){return this.tnRoot.visit(a,b,c)},_createFromTag:function(a,b){var c=this;b.find(">li").each(function(){var d=g(this),e=d.find(">span:first");if(e.length)e=e.html();else{e=
d.html();var f=e.search(/<ul/i);e=f>=0?g.trim(e.substring(0,f)):g.trim(e)}e={title:e,isFolder:d.hasClass("folder"),isLazy:d.hasClass("lazy"),expand:d.hasClass("expanded"),select:d.hasClass("selected"),activate:d.hasClass("active"),focus:d.hasClass("focused")};if(d.attr("title"))e.tooltip=d.attr("title");if(d.attr("id"))e.key=d.attr("id");if(d.attr("data"))if(f=g.trim(d.attr("data"))){if(f.charAt(0)!="{")f="{"+f+"}";try{g.extend(e,eval("("+f+")"))}catch(h){throw"Error parsing node data: "+h+"\ndata:\n'"+
f+"'";}}childNode=a.addChild(e);d=d.find(">ul:first");d.length&&c._createFromTag(childNode,d)})},_checkConsistency:function(){},lastentry:undefined};g.widget("ui.dynatree",{init:function(){_log("warn","ui.dynatree.init() was called; you should upgrade to ui.core.js v1.6 or higher.");return this._init()},_init:function(){logMsg("Dynatree._init(): version='%s', debugLevel=%o.",m.version,this.options.debugLevel);this.options.event+=".dynatree";this.element.get(0);this.tree=new m(this);this.tree._load();
this.tree.logDebug("Dynatree._init(): done.")},bind:function(){function a(f){for(var h=5;f&&h--;){if(f.dtnode)return f.dtnode;f=f.parentNode}return null}function b(f){f=f=g.event.fix(f||window.event);var h=a(f.target);return h?h.onFocus(f):false}var c=this.element,d=this.options;this.unbind();var e="click.dynatree dblclick.dynatree";if(d.keyboard)e+=" keypress.dynatree keydown.dynatree";c.bind(e,function(f){var h=a(f.target);if(!h)return true;var l=h.tree.phase;h.tree.phase="userEvent";try{h.tree.logDebug("bind(%o): dtnode: %o",
f,h);switch(f.type){case "click":return d.onClick&&d.onClick(h,f)===false?false:h.onClick(f);case "dblclick":return d.onDblClick&&d.onDblClick(h,f)===false?false:h.onDblClick(f);case "keydown":return d.onKeydown&&d.onKeydown(h,f)===false?false:h.onKeydown(f);case "keypress":return d.onKeypress&&d.onKeypress(h,f)===false?false:h.onKeypress(f)}}catch(n){}finally{h.tree.phase=l}});c=this.tree.divTree;if(c.addEventListener){c.addEventListener("focus",b,true);c.addEventListener("blur",b,true)}else c.onfocusin=
c.onfocusout=b},unbind:function(){this.element.unbind(".dynatree")},enable:function(){this.bind();g.widget.prototype.enable.apply(this,arguments)},disable:function(){this.unbind();g.widget.prototype.disable.apply(this,arguments)},getTree:function(){return this.tree},getRoot:function(){return this.tree.getRoot()},getActiveNode:function(){return this.tree.getActiveNode()},getSelectedNodes:function(){return this.tree.getSelectedNodes()},lastentry:undefined});g.ui.dynatree.getter="getTree getRoot getActiveNode getSelectedNodes";
g.ui.dynatree.defaults={title:"Dynatree root",rootVisible:false,minExpandLevel:1,imagePath:null,children:null,initId:null,initAjax:null,autoFocus:true,keyboard:true,persist:false,autoCollapse:false,clickFolderMode:3,activeVisible:true,checkbox:false,selectMode:2,fx:null,onClick:null,onDblClick:null,onKeydown:null,onKeypress:null,onFocus:null,onBlur:null,onQueryActivate:null,onQuerySelect:null,onQueryExpand:null,onPostInit:null,onActivate:null,onDeactivate:null,onSelect:null,onExpand:null,onLazyRead:null,
ajaxDefaults:{cache:false,dataType:"json"},strings:{loading:"Loading&#8230;",loadError:"Load error!"},idPrefix:"ui-dynatree-id-",cookieId:"dynatree",cookie:{expires:null},classNames:{container:"ui-dynatree-container",folder:"ui-dynatree-folder",document:"ui-dynatree-document",empty:"ui-dynatree-empty",vline:"ui-dynatree-vline",expander:"ui-dynatree-expander",connector:"ui-dynatree-connector",checkbox:"ui-dynatree-checkbox",nodeIcon:"ui-dynatree-icon",title:"ui-dynatree-title",nodeError:"ui-dynatree-statusnode-error",
nodeWait:"ui-dynatree-statusnode-wait",hidden:"ui-dynatree-hidden",combinedExpanderPrefix:"ui-dynatree-exp-",combinedIconPrefix:"ui-dynatree-ico-",hasChildren:"ui-dynatree-has-children",active:"ui-dynatree-active",selected:"ui-dynatree-selected",expanded:"ui-dynatree-expanded",lazy:"ui-dynatree-lazy",focused:"ui-dynatree-focused",partsel:"ui-dynatree-partsel",lastsib:"ui-dynatree-lastsib"},debugLevel:1,lastentry:undefined};g.ui.dynatree.nodedatadefaults={title:null,key:null,isFolder:false,isLazy:false,
tooltip:null,icon:null,addClass:null,activate:false,focus:false,expand:false,select:false,hideCheckbox:false,unselectable:false,children:null,lastentry:undefined}})(jQuery);var _rexDtLibName=/.*dynatree[^/]*\.js$/i;
